"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[748],{2858:(s,n,e)=>{e.r(n),e.d(n,{assets:()=>o,contentTitle:()=>h,default:()=>u,frontMatter:()=>m,metadata:()=>a,moduleName:()=>d,toc:()=>p});const a=JSON.parse('{"id":"solutions/TVS2025/ThomasJCrook","title":"ThomasJCrook","description":"Tags: MST, DSU","source":"@site/docs/solutions/TVS2025/ThomasJCrook.mdx","sourceDirName":"solutions/TVS2025","slug":"/solutions/TVS2025/ThomasJCrook","permalink":"/SeaFarmers/docs/solutions/TVS2025/ThomasJCrook","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"defaultSidebar","previous":{"title":"TheManshion","permalink":"/SeaFarmers/docs/solutions/TVS2025/TheManshion"},"next":{"title":"ToEatOrNotToEat","permalink":"/SeaFarmers/docs/solutions/TVS2025/ToEatOrNotToEat"}}');var t=e(4848),i=e(8453),l=(e(6540),e(2407),e(8092)),r=e(8866),c=e(426);const m={},h="Thomas J. Crook Solution",o={},d="LearnToCode",p=[];function x(s){const n={annotation:"annotation",h1:"h1",header:"header",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",msup:"msup",p:"p",semantics:"semantics",span:"span",...(0,i.R)(),...s.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.A,{moduleName:d}),"\n",(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"thomas-j-crook-solution",children:"Thomas J. Crook Solution"})}),"\n",(0,t.jsx)(n.p,{children:"Tags: MST, DSU"}),"\n",(0,t.jsxs)(n.h1,{id:"subtask-with-n-leq-102",children:["Subtask with ",(0,t.jsxs)(n.span,{className:"katex",children:[(0,t.jsx)(n.span,{className:"katex-mathml",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{children:"n"}),(0,t.jsx)(n.mo,{children:"\u2264"}),(0,t.jsxs)(n.msup,{children:[(0,t.jsx)(n.mn,{children:"10"}),(0,t.jsx)(n.mn,{children:"2"})]})]}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"n \\leq 10^2"})]})})}),(0,t.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(n.span,{className:"base",children:[(0,t.jsx)(n.span,{className:"strut",style:{height:"0.7719em",verticalAlign:"-0.136em"}}),(0,t.jsx)(n.span,{className:"mord mathnormal",children:"n"}),(0,t.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(n.span,{className:"mrel",children:"\u2264"}),(0,t.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(n.span,{className:"base",children:[(0,t.jsx)(n.span,{className:"strut",style:{height:"0.8141em"}}),(0,t.jsx)(n.span,{className:"mord",children:"1"}),(0,t.jsxs)(n.span,{className:"mord",children:[(0,t.jsx)(n.span,{className:"mord",children:"0"}),(0,t.jsx)(n.span,{className:"msupsub",children:(0,t.jsx)(n.span,{className:"vlist-t",children:(0,t.jsx)(n.span,{className:"vlist-r",children:(0,t.jsx)(n.span,{className:"vlist",style:{height:"0.8141em"},children:(0,t.jsxs)(n.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(n.span,{className:"mord mtight",children:"2"})})]})})})})})]})]})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"We can simply build the MST using Prim's algorithm for each island."}),"\n",(0,t.jsxs)(n.p,{children:["This runs in ",(0,t.jsxs)(n.span,{className:"katex",children:[(0,t.jsx)(n.span,{className:"katex-mathml",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{mathvariant:"script",children:"O"}),(0,t.jsx)(n.mo,{stretchy:"false",children:"("}),(0,t.jsxs)(n.msup,{children:[(0,t.jsx)(n.mi,{children:"n"}),(0,t.jsx)(n.mn,{children:"2"})]}),(0,t.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\mathcal{O}(n^2)"})]})})}),(0,t.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(n.span,{className:"base",children:[(0,t.jsx)(n.span,{className:"strut",style:{height:"1.0641em",verticalAlign:"-0.25em"}}),(0,t.jsx)(n.span,{className:"mord mathcal",style:{marginRight:"0.02778em"},children:"O"}),(0,t.jsx)(n.span,{className:"mopen",children:"("}),(0,t.jsxs)(n.span,{className:"mord",children:[(0,t.jsx)(n.span,{className:"mord mathnormal",children:"n"}),(0,t.jsx)(n.span,{className:"msupsub",children:(0,t.jsx)(n.span,{className:"vlist-t",children:(0,t.jsx)(n.span,{className:"vlist-r",children:(0,t.jsx)(n.span,{className:"vlist",style:{height:"0.8141em"},children:(0,t.jsxs)(n.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(n.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,t.jsx)(n.span,{className:"mclose",children:")"})]})})]})]}),"\n",(0,t.jsx)(n.h1,{id:"naive-implementation",children:"Naive Implementation"}),"\n",(0,t.jsx)("div",{style:{transform:"translateX(150px)"},children:(0,t.jsx)(r.A,{language:"cpp",style:c.A,children:"#include <queue>\n#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <iostream> \n#include <algorithm>\n#include <map>\nusing namespace std;\n\nint n, m; \nstring z; \nvector<vector<pair<int, int>>> a; \nlong long get(int x) {\n  long long t = 0, ret = 0;\n  priority_queue<pair<long long, int>> q; \n  q.push({0, x}); \n  vector<bool> b(n, false); \n  while(!q.empty()) {\n      auto u = q.top(); q.pop(); \n      if(b[u.second]) continue; \n      b[u.second] = true; \n      t -= u.first; \n      if(z[u.second] == '1') ret += t; \n      for(auto &l : a[u.second]) q.push({-l.second, l.first}); \n  }\n  return ret; \n}\nint main() {\n  cin >> n >> m >> z; \n  a = vector<vector<pair<int, int>>>(n); \n  for(int i = 0; i < m; i++) {\n      int x, y, z; \n      cin >> x >> y >> z; \n      x--, y--; \n      a[x].push_back({y, z});\n      a[y].push_back({x, z});\n  }\n  for(int i = 0; i < n; i++) cout << get(i) << endl;\n}\n"})}),"\n",(0,t.jsx)(n.h1,{id:"full-solution",children:"Full Solution"}),"\n",(0,t.jsx)(n.p,{children:"If we sort the edges by weight then after two islands visit each other and all edges of lower weight,\nthe islands behave the same from then on. Thus, we can merge them in a DSU where to get the answer for a\ncertain island, we go up the nodes."}),"\n",(0,t.jsxs)(n.p,{children:["This runs in ",(0,t.jsxs)(n.span,{className:"katex",children:[(0,t.jsx)(n.span,{className:"katex-mathml",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{mathvariant:"script",children:"O"}),(0,t.jsx)(n.mo,{stretchy:"false",children:"("}),(0,t.jsxs)(n.msub,{children:[(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{children:"log"}),(0,t.jsx)(n.mo,{children:"\u2061"})]}),(0,t.jsx)(n.mn,{children:"2"})]}),(0,t.jsx)(n.mo,{stretchy:"false",children:"("}),(0,t.jsx)(n.mi,{children:"n"}),(0,t.jsx)(n.mo,{stretchy:"false",children:")"}),(0,t.jsx)(n.mo,{children:"\u2217"}),(0,t.jsx)(n.mi,{children:"n"}),(0,t.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\mathcal{O}(\\log_2(n)*n)"})]})})}),(0,t.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(n.span,{className:"base",children:[(0,t.jsx)(n.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(n.span,{className:"mord mathcal",style:{marginRight:"0.02778em"},children:"O"}),(0,t.jsx)(n.span,{className:"mopen",children:"("}),(0,t.jsxs)(n.span,{className:"mop",children:[(0,t.jsxs)(n.span,{className:"mop",children:["lo",(0,t.jsx)(n.span,{style:{marginRight:"0.01389em"},children:"g"})]}),(0,t.jsx)(n.span,{className:"msupsub",children:(0,t.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(n.span,{className:"vlist-r",children:[(0,t.jsx)(n.span,{className:"vlist",style:{height:"0.207em"},children:(0,t.jsxs)(n.span,{style:{top:"-2.4559em",marginRight:"0.05em"},children:[(0,t.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(n.span,{className:"mord mtight",children:"2"})})]})}),(0,t.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(n.span,{className:"vlist-r",children:(0,t.jsx)(n.span,{className:"vlist",style:{height:"0.2441em"},children:(0,t.jsx)(n.span,{})})})]})})]}),(0,t.jsx)(n.span,{className:"mopen",children:"("}),(0,t.jsx)(n.span,{className:"mord mathnormal",children:"n"}),(0,t.jsx)(n.span,{className:"mclose",children:")"}),(0,t.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.jsx)(n.span,{className:"mbin",children:"\u2217"}),(0,t.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,t.jsxs)(n.span,{className:"base",children:[(0,t.jsx)(n.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(n.span,{className:"mord mathnormal",children:"n"}),(0,t.jsx)(n.span,{className:"mclose",children:")"})]})]})]})]}),"\n",(0,t.jsx)(n.h1,{id:"implementation",children:"Implementation"}),"\n",(0,t.jsx)("div",{style:{transform:"translateX(150px)"},children:(0,t.jsx)(r.A,{language:"cpp",style:c.A,children:"#include <queue>\n#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <iostream> \n#include <algorithm>\n#include <map>\nusing namespace std;\n\nint cur; \nstruct stuff {\n  long long x, y, z; \n};\nstruct node {\n  long long val, t, ct; \n  int p; \n  node (int tct) : val(0), t(0), ct(tct), p(cur++) {}\n};\nvector<node> dsu; \nnode plop(node x, node y) {\n  x.val += y.val + y.ct * x.t; \n  x.t += y.t; \n  x.ct += y.ct; \n  x.p = y.p; \n  return x; \n}\nnode get(int x) {\n  return dsu[x].p == x ? dsu[x] : dsu[x] = plop(dsu[x], get(dsu[x].p));\n}\nvoid merge(int x, int y, int len) {\n  node vx = get(x), vy = get(y); \n  if(vx.p == vy.p) return; \n  dsu[vx.p].t += len, dsu[vy.p].t += len; \n  dsu[vx.p] = plop(dsu[vx.p], vy); \n  dsu[vy.p] = plop(dsu[vy.p], vx); \n\n  dsu.push_back(node(0)); \n  dsu[vx.p].p = dsu[vy.p].p = dsu.back().p; \n}\nint main() {\n  int n, m; \n  string z; \n  cin >> n >> m >> z; \n  for(int i = 0; i < n; i++) dsu.push_back(node(z[i] - '0')); \n  vector<stuff> a(m); \n  for(auto &u : a) cin >> u.x >> u.y >> u.z; \n  for(auto &u : a) u.x--, u.y--; \n  sort(a.begin(), a.end(), [](auto a, auto b){ return a.z < b.z; }); \n  for(auto &u : a) merge(u.x, u.y, u.z); \n  for(int i = 0; i < n; i++) cout << get(i).val << endl;\n}\n"})})]})}function u(s={}){const{wrapper:n}={...(0,i.R)(),...s.components};return n?(0,t.jsx)(n,{...s,children:(0,t.jsx)(x,{...s})}):x(s)}}}]);